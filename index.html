<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <title>मेरीBUS</title>
  <link rel="stylesheet" href="styles.css" />
  
</head>
<body>
  <div id="splash-video" class="splash-video-overlay">
    <video id="splashVideo" class="splash-video" autoplay muted playsinline>
      <source src="WhatsApp Video 2025-09-20 at 20.18.20_81898b1f.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
  <div id="main-app">
  <header class="topbar">
    <div class="container topbar-inner">
      <div class="brand">
        <img src="WhatsApp Image 2025-09-14 at 01.51.41_dc573c91.png" alt="MeriBus Logo" class="logo-img">
        <div class="brand-text">
          <div class="app-title">मेरीBUS</div>
          <div class="subtitle" data-i18n="subtitle">अब सफ़र होगा आसान</div>
        </div>
      </div>
      <div class="top-controls">
        <div class="location">
          <div class="loc-label" data-i18n="currentLocation">Current Location</div>
          <div class="loc-value" id="current-location">Pune, Maharashtra</div>
          <button class="btn ghost" id="show-location-btn" style="margin-top:6px;" data-i18n="showLocation">Show Current Location</button>
          <div id="geo-coords" class="geo-coords" style="display:none;"></div>
          <div id="geo-city-match" class="geo-city-match" style="display:none;"></div>
        </div>
        <div class="lang-select">
          <select id="language" onchange="switchLanguage()" aria-label="Language">
            <option value="en" selected>English</option>
            <option value="hi">हिन्दी</option>
            <option value="pa">ਪੰਜਾਬੀ</option>
            <option value="mr">मराठी</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <main class="container main-grid">
    <!-- Planner card -->
    <section class="card planner">
      <h2 id="planTitle">Plan Your Journey</h2>

      <label id="sourceLabel" for="source">Source</label>
      <input id="source" type="text" placeholder="Enter Source Stop" oninput="filterStops('source')" autocomplete="off" />
      <ul id="source-suggestions" class="suggestions hidden"></ul>

      <label id="destinationLabel" for="destination">Destination</label>
      <input id="destination" type="text" placeholder="Enter Destination Stop" oninput="filterStops('destination')" autocomplete="off" />
      <ul id="destination-suggestions" class="suggestions hidden"></ul>

      <div class="planner-row">
  <button id="find-route" class="btn primary" onclick="findRoute()" data-i18n="findRoute">Find Best Route</button>
        <div id="route-result" class="muted" style="margin-top: 12px;"></div>
  <div id="trip-info-card" class="trip-info-card" style="display:none;"></div>
        <!-- <div class="eta-summary">
          <div class="eta-item"><strong id="eta-1">5 min</strong><div id="eta-1-status" class="status ontime">On time</div></div>
          <div class="eta-item"><strong id="eta-2">12 min</strong><div id="eta-2-status" class="status delayed">Delayed</div></div>
          <div class="eta-item"><strong id="eta-3">8 min</strong><div id="eta-3-status" class="status ontime">On time</div></div>
        </div> -->
      </div>
    </section>

    <!-- Live buses -->
    <section class="card live-buses">
      <div class="card-head">
  <h3 data-i18n="liveBuses">Live Buses Near You</h3>
  <small class="muted" data-i18n="liveBusesCount">3 Live Buses</small>
      </div>

      <div id="live-bus-list" class="bus-list">
        <!-- Bus cards injected by JS -->
      </div>

      <div class="quick-actions">
  <button class="btn ghost" onclick="reportStatus()" data-i18n="reportStatus">Report Bus Status</button>
  <button class="btn ghost" onclick="setArrivalAlert()" data-i18n="setArrivalAlert">Set Arrival Alert</button>
  <button class="btn ghost" onclick="shareLocation()" data-i18n="shareLocation">Share Location</button>
    <!-- Share Location Modal -->
    <div id="share-modal" class="share-modal" style="display:none;">
      <div class="share-modal-content share-modal-animate">
        <button class="share-modal-close" onclick="closeShareModal()" aria-label="Close">&times;</button>
  <h4 style="margin-bottom: 18px;" data-i18n="shareYourLocation">Share Your Location</h4>
        <div class="share-copy-row">
          <button class="share-copy-btn" onclick="copyLocationLink()">
            <span class="share-icon-svg" aria-hidden="true" style="color:#1976d2;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12a5.1 5.1 0 0 1 5.1-5.1h2V5.1a7.8 7.8 0 1 0 7.8 7.8v-2h-1.8v2A6 6 0 1 1 9 6v2h2A5.1 5.1 0 1 1 3.9 12Z" fill="#1976d2"/><rect x="11" y="7" width="2" height="10" rx="1" fill="#1976d2"/></svg>
            </span>
            <span style="color:#222; font-weight:500;" data-i18n="copyLink">Copy Link</span>
          </button>
        </div>
        <div class="share-block-row">
          <div class="share-block whatsapp" onclick="shareViaWhatsApp()">
            <span class="share-icon-svg" aria-hidden="true">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="#25D366"/><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.472-.148-.67.15-.198.297-.767.967-.94 1.165-.173.198-.347.223-.644.075-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.372-.025-.521-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.67-.51-.173-.007-.372-.009-.571-.009-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.099 3.205 5.077 4.367.71.306 1.263.489 1.695.626.712.227 1.36.195 1.872.118.571-.085 1.758-.719 2.007-1.413.248-.694.248-1.288.173-1.413-.074-.124-.272-.198-.57-.347z" fill="#fff"/></svg>
            </span>
            <span style="color:#222; font-weight:500;" data-i18n="whatsapp">WhatsApp</span>
          </div>
          <div class="share-block sms" onclick="shareViaSMS()">
            <span class="share-icon-svg" aria-hidden="true">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="12" fill="#007AFF"/><path d="M6 8.5A2.5 2.5 0 0 1 8.5 6h7A2.5 2.5 0 0 1 18 8.5v7A2.5 2.5 0 0 1 15.5 18h-7A2.5 2.5 0 0 1 6 15.5v-7Zm1.75.75a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5Z" fill="#fff"/></svg>
            </span>
            <span style="color:#222; font-weight:500;" data-i18n="sms">SMS</span>
          </div>
        </div>
      </div>
    </div>
      </div>
    </section>

    <!-- Traffic & Map placeholder -->
    <section class="card traffic">
  <h3 data-i18n="trafficUpdates">Traffic Updates</h3>
      <div class="traffic-list" id="traffic-list">
        <!-- Items injected by JS -->
      </div>
      <div class="map-container">
  <iframe
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3782.2827364894935!2d73.856743!3d18.520430!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bc2c06d5eaf8a6b%3A0x2d1f1dfb2b1a4b5!2sPune%2C%20Maharashtra!5e0!3m2!1sen!2sin!4v1690000000000"
    width="100%"
    height="250"
    style="border:0; border-radius: 8px;"
    allowfullscreen=""
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade">
  </iframe>
  <div id="user-marker" class="user-marker" style="display:none;"></div>
</div>

    </section>

    <!-- Features / Solutions -->


    <!-- Future features -->
    <section class="card future">
  <h3 data-i18n="extraFeatures">Extra Innovative Features</h3>
      <ul class="future-list">
     
  <li data-i18n="crowdingPrediction">Bus Crowding Prediction based on historical data</li>
  <li data-i18n="routeOptimization">Route Optimization suggestions for authorities</li>
  <li data-i18n="offlineFirst">Offline-first functionality for poor networks</li>
      </ul>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
  <div data-i18n="footer">© <span id="year"></span> BusTracker — Built for SIH demo</div>
  <div class="muted" data-i18n="footerDesc">Multi-language, offline-first design & simple UI</div>
    </div>
  </footer>


  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
























































  +++++++++++
  <script src="script.js"></script>

<script>
// Update all elements with data-i18n attribute
function updateAllI18n() {
  let lang = localStorage.getItem("lang") || document.getElementById("language").value || "en";
  const t = translations[lang] || translations.en;
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (t[key]) {
      if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
        el.placeholder = t[key];
      } else {
        el.innerHTML = t[key];
      }
    }
  });
}
// Patch switchLanguage to update all i18n
const origSwitchLanguage = window.switchLanguage;
window.switchLanguage = function() {
  if (origSwitchLanguage) origSwitchLanguage();
  updateAllI18n();
}
// On load, update all i18n
document.addEventListener('DOMContentLoaded', updateAllI18n);
</script>

<style>
.share-modal-content {
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.18);
  padding: 32px 20px 24px 20px;
  max-width: 370px;
  margin: 40px auto;
  position: relative;
  opacity: 0;
  transform: translateY(40px) scale(0.98);
  transition: opacity 0.32s cubic-bezier(.4,1.4,.6,1), transform 0.32s cubic-bezier(.4,1.4,.6,1);
}
.share-modal-content.share-modal-animate {
  opacity: 1;
  transform: translateY(0) scale(1);
}
.share-modal-close {
  position: absolute;
  top: 12px;
  right: 16px;
  background: none;
  border: none;
  font-size: 1.7rem;
  color: #888;
  cursor: pointer;
}
.share-copy-row {
  width: 100%;
  margin-bottom: 18px;
}
.share-copy-btn {
  width: 100%;
  background: #f5f5f5;
  border: none;
  border-radius: 10px;
  padding: 12px 0;
  font-size: 1.1rem;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  cursor: pointer;
  transition: background 0.18s;
}
.share-copy-btn:hover {
  background: #e3e3e3;
}
.share-block-row {
  display: flex;
  gap: 16px;
  justify-content: space-between;
  margin-bottom: 2px;
}
.share-block {
  flex: 1 1 0;
  background: #f5f5f5;
  border-radius: 10px;
  padding: 18px 0 14px 0;
  font-size: 1.08rem;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  cursor: pointer;
  transition: background 0.18s, box-shadow 0.18s;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  border: 2px solid transparent;
  outline: none;
}
.share-block.whatsapp:hover {
  background: #e9f7ef;
  border-color: #25D366;
}
.share-block.sms:hover {
  background: #eaf1fb;
  border-color: #007AFF;
}
.share-icon-svg {
  width: 22px;
  height: 22px;
  display: inline-block;
  vertical-align: middle;
  flex-shrink: 0;
}
@media (max-width: 600px) {
  .share-modal-content {
    max-width: 98vw;
    padding: 18px 4vw 18px 4vw;
  }
  .share-block-row {
    flex-direction: column;
    gap: 10px;
  }
  .share-block {
    padding: 14px 0 12px 0;
    font-size: 1rem;
  }
}

.share-modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.18);
  z-index: 1000;
  display: none;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  min-width: 100vw;
}
.share-modal.active {
  display: flex !important;
}
</style>

<script>
// Animate share modal appearance
function openShareModal() {
  const modal = document.getElementById('share-modal');
  if (modal) {
    modal.classList.add('active');
    setTimeout(() => {
      const content = modal.querySelector('.share-modal-content');
      if (content) content.classList.add('share-modal-animate');
    }, 10);
  }
}
function closeShareModal() {
  const modal = document.getElementById('share-modal');
  if (modal) {
    const content = modal.querySelector('.share-modal-content');
    if (content) content.classList.remove('share-modal-animate');
    setTimeout(() => {
      modal.classList.remove('active');
    }, 250);
  }
}
// Replace old shareLocation() to use new modal
function shareLocation() {
  openShareModal();
}
</script>

<script>
// Geolocation logic for "Show Current Location" button with city match
const MAHA_CITIES = [
  { name: "Mumbai", lat: 19.0760, lon: 72.8777 },
  { name: "Pune", lat: 18.5204, lon: 73.8567 },
  { name: "Nagpur", lat: 21.1458, lon: 79.0882 },
  { name: "Nashik", lat: 19.9975, lon: 73.7898 },
  { name: "Aurangabad", lat: 19.8762, lon: 75.3433 },
  { name: "Solapur", lat: 17.6599, lon: 75.9064 },
  { name: "Amravati", lat: 20.9374, lon: 77.7796 },
  { name: "Kolhapur", lat: 16.7050, lon: 74.2433 },
  { name: "Sangli", lat: 16.8524, lon: 74.5815 },
  { name: "Jalgaon", lat: 21.0077, lon: 75.5626 },
  { name: "Akola", lat: 20.7002, lon: 77.0082 },
  { name: "Latur", lat: 18.4088, lon: 76.5604 },
  { name: "Dhule", lat: 20.9042, lon: 74.7749 },
  { name: "Ahmednagar", lat: 19.0948, lon: 74.7477 },
  { name: "Chandrapur", lat: 19.9615, lon: 79.2961 },
  { name: "Parbhani", lat: 19.2704, lon: 76.7601 },
  { name: "Nanded", lat: 19.1383, lon: 77.3210 },
  { name: "Beed", lat: 18.9891, lon: 75.7601 },
  { name: "Wardha", lat: 20.7453, lon: 78.6022 },
  { name: "Jalna", lat: 19.8410, lon: 75.8864 },
  { name: "Yavatmal", lat: 20.3888, lon: 78.1204 },
  { name: "Satara", lat: 17.6805, lon: 74.0183 },
  { name: "Gondia", lat: 21.4602, lon: 80.1920 },
  { name: "Baramati", lat: 18.1510, lon: 74.5777 },
  { name: "Osmanabad", lat: 18.1860, lon: 76.0419 },
  { name: "Panvel", lat: 18.9888, lon: 73.1101 },
  { name: "Ratnagiri", lat: 16.9902, lon: 73.3120 },
  { name: "Bhiwandi", lat: 19.2813, lon: 73.0483 },
  { name: "Malegaon", lat: 20.5537, lon: 74.5257 },
  { name: "Navi Mumbai", lat: 19.0330, lon: 73.0297 }
];

function haversine(lat1, lon1, lat2, lon2) {
  const toRad = x => x * Math.PI / 180;
  const R = 6371; // km
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
            Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R * c;
}

document.addEventListener("DOMContentLoaded", function() {
  const btn = document.getElementById("show-location-btn");
  const coordsDiv = document.getElementById("geo-coords");
  const locValue = document.getElementById("current-location");
  const userMarker = document.getElementById("user-marker");
  const cityMatchDiv = document.getElementById("geo-city-match");
  if (btn) {
    btn.addEventListener("click", function() {
      if (!navigator.geolocation) {
        coordsDiv.style.display = "block";
        coordsDiv.textContent = "Geolocation is not supported by your browser.";
        coordsDiv.className = "geo-coords error";
        cityMatchDiv.style.display = "none";
        return;
      }
      coordsDiv.style.display = "block";
      coordsDiv.textContent = "Locating...";
      coordsDiv.className = "geo-coords locating";
      cityMatchDiv.style.display = "none";
      navigator.geolocation.getCurrentPosition(function(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        coordsDiv.textContent = `Lat: ${lat.toFixed(4)}, Lng: ${lon.toFixed(4)}`;
        coordsDiv.className = "geo-coords success";
        locValue.textContent = `Lat: ${lat.toFixed(4)}, Lon: ${lon.toFixed(4)}`;
        // Find closest city
        let minDist = Infinity, closest = null;
        for (const city of MAHA_CITIES) {
          const dist = haversine(lat, lon, city.lat, city.lon);
          if (dist < minDist) {
            minDist = dist;
            closest = city;
          }
        }
        if (closest && minDist < 50) { // 50km threshold
          cityMatchDiv.style.display = "block";
          cityMatchDiv.textContent = `Approximate location: ${closest.name} (${minDist.toFixed(1)} km away)`;
          cityMatchDiv.className = "geo-city-match success";
        } else {
          cityMatchDiv.style.display = "block";
          cityMatchDiv.textContent = "Could not match to a major Maharashtra city.";
          cityMatchDiv.className = "geo-city-match error";
        }
        // Optionally, show a marker on the map (simple overlay)
        if (userMarker) {
          userMarker.style.display = "block";
          userMarker.textContent = "📍 You are here";
          userMarker.style.position = "absolute";
          userMarker.style.top = "16px";
          userMarker.style.left = "16px";
          userMarker.style.background = "#1976d2";
          userMarker.style.color = "#fff";
          userMarker.style.padding = "4px 10px";
          userMarker.style.borderRadius = "16px";
          userMarker.style.fontWeight = "bold";
          userMarker.style.boxShadow = "0 2px 8px rgba(0,0,0,0.12)";
        }
      }, function(error) {
        coordsDiv.style.display = "block";
        coordsDiv.className = "geo-coords error";
        cityMatchDiv.style.display = "block";
        cityMatchDiv.className = "geo-city-match error";
        if (error.code === error.PERMISSION_DENIED) {
          coordsDiv.textContent = "Location access denied by user.";
          cityMatchDiv.textContent = "Location access denied by user.";
        } else if (error.code === error.POSITION_UNAVAILABLE) {
          coordsDiv.textContent = "Location information is unavailable.";
          cityMatchDiv.textContent = "Location information is unavailable.";
        } else if (error.code === error.TIMEOUT) {
          coordsDiv.textContent = "Location request timed out.";
          cityMatchDiv.textContent = "Location request timed out.";
        } else {
          coordsDiv.textContent = "An unknown error occurred.";
          cityMatchDiv.textContent = "An unknown error occurred.";
        }
      });
    });
  }
});
/* Geo city match styling */
.geo-city-match {
  margin-top: 6px;
  font-size: 1rem;
  color: #1976d2;
  background: #f5faff;
  border-radius: 7px;
  padding: 7px 12px;
  border: 1px solid #e3e8ee;
  display: block;
  transition: background 0.2s, color 0.2s;
}
.geo-city-match.success {
  color: #1976d2;
  background: #eaf6ff;
  border-color: #b3e0ff;
}
.geo-city-match.error {
  color: #b71c1c;
  background: #fff0f0;
  border-color: #ffcdd2;
}
</script>

  </div> <!-- end main-app -->

<style>
/* Geo city match styling */
.geo-city-match {
  margin-top: 6px;
  font-size: 1rem;
  color: #1976d2;
  background: #f5faff;
  border-radius: 7px;
  padding: 7px 12px;
  border: 1px solid #e3e8ee;
  display: block;
  transition: background 0.2s, color 0.2s;
}
.geo-city-match.success {
  color: #1976d2;
  background: #eaf6ff;
  border-color: #b3e0ff;
}
.geo-city-match.error {
  color: #b71c1c;
  background: #fff0f0;
  border-color: #ffcdd2;
}
/* Splash Video Responsive Styles */
.splash-video-overlay {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  background: #111; /* fallback color */
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: opacity 0.7s cubic-bezier(.4,1.4,.6,1);
  opacity: 1;
  overflow: hidden;
}
.splash-video-overlay.hide {
  opacity: 0;
  pointer-events: none;
}
.splash-video {
  width: 100vw;
  height: 100vh;
  min-width: 100vw;
  min-height: 100vh;
  object-fit: cover;
  object-position: center center;
  background: #111;
  display: block;
  position: absolute;
  top: 0; left: 0;
}
@media (max-width: 900px) {
  .splash-video {
    width: 100vw;
    height: 100vh;
    min-width: 100vw;
    min-height: 100vh;
  }
}
</style>

<script>
// Splash video logic
document.addEventListener('DOMContentLoaded', function() {
  const splash = document.getElementById('splash-video');
  const splashVideo = document.getElementById('splashVideo');
  const mainApp = document.getElementById('main-app');
  let splashDone = false;
  function hideSplash() {
    if (splashDone) return;
    splashDone = true;
    splash.classList.add('hide');
    setTimeout(() => {
      splash.style.display = 'none';
      if (mainApp) mainApp.style.display = '';
    }, 700);
  }
  if (mainApp) mainApp.style.display = 'none';
  if (splashVideo) {
    splashVideo.addEventListener('ended', hideSplash);
    // Fallback: hide after 6 seconds if video doesn't end
    setTimeout(hideSplash, 6000);
  } else {
    // If video not found, just show app
    hideSplash();
  }
});
</script>
</html>
